{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Produtos</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <link rel="stylesheet" type="text/css" href="{% static 'css/estilo.css' %}" />
</head>
<body>
  {% include "componentes/navbar.html" %}
  <div id="liveAlertPlaceholder"></div>
  <div class="custom-container">
    <div class="row m-0">
      <div class="d-flex align-items-center p-0 mb-4">
        <a href="{{ request.session.previous_url }}" class="d-flex">
          <img class="custom-img" src="{% static 'img/voltar.svg' %}" alt="" />
        </a>
        <h5 class="custom-title">Produtos</h5>
      </div>
      <div class="col-7 border boder-secondary rounded me-5 d-flex flex-column custom-container-2">
        <div class="col-6 custom-col-pb-30">
          <input class="form-control" id="pesquisarProduto" placeholder="Pesquisar usuário..." />
        </div>
        <div class="flex-grow-1 mb-3 position-relative custom-wrapper-table">
          <div class="table-responsive position-absolute w-100 h-100">
            <table id="CE_Produto" class="table mb-0 table-hover">
              <thead>
                <tr class="cabecalho">
                  <th scope="col" class="text-secondary">Código</th>
                  <th scope="col" class="text-secondary">Descrição</th>
                  <th scope="col" class="text-secondary">Tipo</th>
                  <th scope="col" class="text-secondary">Categoria</th>
                  <th scope="col" class="text-secondary">Sub-Categoria</th>
                  <th scope="col" class="text-secondary"></th>
                </tr>
              </thead>
              <tbody>
                {% for produto in produtos %}
                <tr data-codigo="{{ produto.codigo }}" 
                    data-descricao="{{ produto.descricao }}"
                    data-peso="{{ produto.peso }}"
                    data-unidade="{{ produto.unidade }}"
                    data-tipo="{{ produto.tipo.id }}"
                    data-categoria="{{ produto.categoria.id }}"
                    data-sub-categoria="{{ produto.sub_categoria.id }}"
                    data-embalagem="{{ produto.embalagem.id }}"
                    data-tipo-peso="{{ produto.tipo_peso }}"
                    class="produto-row">
                  <td class="text-secondary">{{ produto.codigo }}</td>
                  <td class="text-secondary text-truncate" title="{{ produto.descricao }}">
                    {{ produto.descricao }}
                  </td>
                  <td class="text-secondary text-truncate" title="{{ produto.tipo.descricao }}" style="max-width: 70px;">
                    {{ produto.tipo.descricao }}
                  </td>
                  <td class="text-secondary text-truncate" title="{{ produto.categoria.descricao }}" style="max-width: 90px;">
                    {{ produto.categoria.descricao }}
                  </td>
                  <td class="text-secondary text-truncate" title="{{ produto.sub_categoria.descricao }}">
                    {{ produto.sub_categoria.descricao }}
                  </td>
                  <td class="text-end">
                    <img src="{% static 'img/editar.svg' %}" class="editarRegistro" data-id="{{ produto.codigo }}" alt="Editar" />
                    <img src="{% static 'img/deletar.svg' %}" class="excluirProduto" data-id="{{ produto.codigo }}" alt="Excluir" />
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
        <button id="novoProduto"
          class="custom-button-2 rounded d-flex justify-content-between align-items-center ms-auto">
          <span>Novo</span>
          <span>
            <img class="custom-mb" src="{% static 'img/novo.svg' %}" alt="" />
          </span>
        </button>
      </div>
      <div id="formularioProduto"
      class="col-4 align-items-start justify-content-start border-start boder-secondary ps-5 custom-col-height{% if not produto %} d-none{% endif %}">
      <div class="d-flex align-items-center p-0 mb-4">
        <img class="custom-img" src="{% static 'img/voltar.svg' %}" alt="" />
        <h5 class="custom-title">Cadastrar Produto</h5>
      </div>
      <div class="row g-3">
        <div class="col-4 mb-2">
          <input type="text" class="form-control" placeholder="Código" aria-label="codigo" id="codigo" />
        </div>
        <div class="col-8 mb-2">
          <input type="text" class="form-control" placeholder="Descrição" aria-label="descricao" id="descricao" />
        </div>
        <div class="col-12 mb-2">
          <div class="dropdown">
            <button id="tipo-options" class="form-select text-start user-select-none" type="button"
              data-bs-toggle="dropdown" data-bs-auto-close="false" aria-expanded="false">
              Tipo
            </button>
            <ul class="dropdown-menu w-100 custom-dropdown" id="tipos-container">
              {% for tipo in tipos %}
              <li class="d-flex user-select-none" data-tipo-codigo="{{ tipo.codigo }}">
                <input class="form-check-input me-2" type="radio" value="{{ tipo.id }}" id="tipoCheck{{ tipo.codigo }}" name="tipo" />
                <label class="form-check-label w-100" for="tipoCheck{{ tipo.codigo }}">
                  {{ tipo.descricao }}
                </label>
              </li>
              {% endfor %}
            </ul>
          </div>
        </div>
        
        <div class="col-12 mb-2">
          <div class="dropdown">
            <button id="categoria-options" class="form-select text-start user-select-none" type="button"
              data-bs-toggle="dropdown" data-bs-auto-close="false" aria-expanded="false">
              Categoria
            </button>
            <ul class="dropdown-menu w-100 custom-dropdown" id="categorias-container">
              {% for categoria in categorias %}
              <li class="d-flex user-select-none" data-categoria-codigo="{{ categoria.codigo }}" data-tipo="{{ categoria.tipo.id }}">
                <input class="form-check-input me-2" type="radio" value="{{ categoria.id }}" id="categoriaCheck{{ categoria.codigo }}" name="categoria" />
                <label class="form-check-label w-100" for="categoriaCheck{{ categoria.codigo }}">
                  {{ categoria.descricao }}
                </label>
              </li>
              {% endfor %}
            </ul>
          </div>
        </div>
        
        <div class="col-12 mb-2">
          <div class="dropdown">
            <button id="subcategoria-options" class="form-select text-start user-select-none" type="button"
              data-bs-toggle="dropdown" data-bs-auto-close="false" aria-expanded="false">
              Sub-Categoria
            </button>
            <ul class="dropdown-menu w-100 custom-dropdown" id="subcategorias-container">
              {% for subcategoria in subcategorias %}
              <li class="d-flex user-select-none" data-subcategoria-codigo="{{ subcategoria.codigo }}" data-categoria="{{ subcategoria.categoria.id }}">
                <input class="form-check-input me-2" type="radio" value="{{ subcategoria.id }}" id="subcategoriaCheck{{ subcategoria.codigo }}" name="subcategoria" />
                <label class="form-check-label w-100" for="subcategoriaCheck{{ subcategoria.codigo }}">
                  {{ subcategoria.descricao }}
                </label>
              </li>
              {% endfor %}
            </ul>
          </div>
        </div>

        <div class="col-4 mb-2">
          <input type="number" class="form-control" placeholder="Peso" aria-label="peso" id="valor-peso" />
        </div>
        <div class="col-8 mb-2">
          <div class="dropdown">
            <button id="tipo-peso-options" class="form-select text-start user-select-none" type="button"
              data-bs-toggle="dropdown" data-bs-auto-close="false" aria-expanded="false">
              Tipo de Peso
            </button>
            <ul class="dropdown-menu w-100 custom-dropdown" id="pesos-container">
              <li class="d-flex user-select-none" data-peso-codigo="KILO">
                <input class="form-check-input me-2" type="radio" value="KILO" id="pesoCheckKILO" name="peso" />
                <label class="form-check-label w-100" for="pesoCheckKILO">
                  Kilo
                </label>
              </li>
              <li class="d-flex user-select-none" data-peso-codigo="LITRO">
                <input class="form-check-input me-2" type="radio" value="LITRO" id="pesoCheckLITRO" name="peso" />
                <label class="form-check-label w-100" for="pesoCheckLITRO">
                  Litro
                </label>
              </li>
            </ul>
          </div>
        </div>

        <div class="col-4 mb-4">
          <input type="number" class="form-control" placeholder="Unidade" aria-label="Unidade"
            id="valor-unidade-embalagem" />
        </div>
        <div class="col-8 mb-4">
          <div class="dropdown">
            <button id="embalagem-options" class="form-select text-start user-select-none" type="button"
              data-bs-toggle="dropdown" data-bs-auto-close="false" aria-expanded="false">
              Embalagem
            </button>
            <ul class="dropdown-menu w-100 custom-dropdown" id="embalagens-container">
              {% for embalagem in embalagens %}
              <li class="d-flex user-select-none" data-embalagem-codigo="{{ embalagem.codigo }}">
                <input class="form-check-input me-2" type="radio" value="{{ embalagem.codigo }}"
                  id="embalagemCheck{{ embalagem.codigo }}" name="embalagem" />
                <label class="form-check-label w-100" for="embalagemCheck{{ embalagem.codigo }}">
                  {{ embalagem.descricao }}
                </label>
              </li>
              {% endfor %}
            </ul>
          </div>
        </div>

        <div class="col-6">
          <button class="btn-cancelar rounded bg-white text-secondary">
            Cancelar
          </button>
        </div>
        <div class="col-6">
          <button id="salvar"
            class="custom-btn-salvar rounded text-light d-flex justify-content-center align-items-center ms-auto position-relative">
            <span>Salvar</span>
            <span class="spinner-border spinner-border-sm position-absolute custom-r-12 d-none"
              aria-hidden="true"></span>
          </button>
        </div>
      </div>
    </div>
    </div>
  </div>
  {% include "componentes/modal_generica.html" %}
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  <script type="module" src="{% static 'js/telas/produtos.js' %}"></script>
</body>
</html>
