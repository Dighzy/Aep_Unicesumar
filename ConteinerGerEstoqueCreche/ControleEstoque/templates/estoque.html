{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Consultar Estoque</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/estilo.css' %}">
</head>
<body>
    {% include "componentes/navbar.html" %}
    <div class="custom-container">
        <div class="row m-0">
            <div class="d-flex align-items-center p-0 mb-4">
                <a href="{% url 'login' %}" class="d-flex">
                    <img class="custom-img" src="{% static 'img/voltar.svg' %}" alt="" />
                </a>
                <h5 class="custom-title">Consultar Estoque</h5>
            </div>
            <div class="col-7 border boder-secondary rounded me-5 d-flex flex-column custom-container-2">
                <div class="custom-col-pb-30 d-flex align-items-center justify-content-center justify-content-between">
                    <div class="col-6">
                        <input type="text" class="form-control" id="pesquisarProduto" placeholder="Pesquisar produto..." />
                    </div>
                </div>
                <div class="flex-grow-1 mb-3 position-relative custom-wrapper-table">
                    <div class="table-responsive position-absolute w-100 h-100">
                        <table id="CE_Estoque" class="table mb-0 table-hover">
                            <thead>
                                <tr class="cabecalho">
                                    <th scope="col" class="text-secondary">Produto</th>
                                    <th scope="col" class="text-secondary">Descrição</th>
                                    <th scope="col" class="text-secondary">Tipo</th>
                                    <th scope="col" class="text-secondary">Embalagem</th>
                                    <th scope="col" class="text-secondary">Contábil</th>
                                    <th scope="col" class="text-secondary">Categoria</th>
                                    <th scope="col" class="text-secondary">Sub-Categoria</th>
                                    <th scope="col" class="text-secondary"></th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in estoque_items %}
                                <tr data-id="{{ item.produto.id }}" data-tipo="{{ item.produto.tipo_mascarado }}" data-quantidade="{{ item.contabil }}" data-categoria="{{ item.produto.categoria.descricao }}">
                                    <td class="text-secondary">{{ item.produto.codigo }}</td>
                                    <td class="text-secondary">{{ item.produto.descricao }}</td>
                                    <td class="text-secondary">{{ item.produto.tipo_mascarado }}</td>
                                    <td class="text-secondary">{{ item.produto.embalagem.descricao }}</td>
                                    <td class="text-secondary">{{ item.contabil_real }}</td>
                                    <td class="text-secondary">{{ item.produto.categoria.descricao }}</td>
                                    <td class="text-secondary">{{ item.produto.sub_categoria.descricao }}</td>
                                    <td class="text-end"><img src="{% static 'img/registro.svg' %}" alt="" /></td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-4 align-items-start justify-content-start border-start boder-secondary ps-5 custom-col-height">
                <div class="d-flex align-items-center mb-3">
                    <h5 class="custom-title">Histórico de Movimentação</h5>
                </div>
                <div class="flex-grow-1 mb-4">
                    <table class="table mb-0 table-hover" id="CE_Lancamentos">
                        <thead>
                            <tr class="cabecalho">
                                <th scope="col" class="text-secondary">Lanc.</th>
                                <th scope="col" class="text-secondary">Tipo</th>
                                <th scope="col" class="text-secondary">Categoria</th>
                                <th scope="col" class="text-secondary">Total</th>
                                <th scope="col" class="text-secondary">Data</th>
                                <th scope="col" class="text-secondary"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Lançamentos dinâmicos serão inseridos aqui -->
                        </tbody>
                    </table>
                </div>
                <div class="d-flex align-items-center mb-3 pt-1">
                    <h5 class="custom-title">Resumo de Movimentação</h5>
                </div>
                <div class="flex-grow-1 mb-5">
                    <table class="table mb-0 table-hover">
                        <thead>
                            <tr class="cabecalho">
                                <th scope="col" class="text-secondary custom-cell">1º Mov.</th>
                                <th scope="col" class="text-secondary custom-cell">Tipo</th>
                                <th scope="col" class="text-secondary custom-cell">Quantidade</th>
                                <th scope="col" class="text-secondary custom-cell">Categoria</th>
                                <th scope="col" class="text-secondary custom-cell"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="custom-row">
                                <td id="primeiro-movimento" class="text-secondary custom-cell"></td>
                                <td id="tipo-primeiro-movimento" class="text-secondary custom-cell"></td>
                                <td id="quantidade-primeiro-movimento" class="text-secondary custom-cell"></td>
                                <td id="categoria-primeiro-movimento" class="text-secondary custom-cell"></td>
                                <td class="text-end custom-cell">
                                    <img src="{% static 'img/registro-2.svg' %}" alt="" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table mt-3 p-0 table-hover w-100">
                        <thead>
                            <tr class="cabecalho">
                                <th scope="col" class="text-secondary">Ult. Mov.</th>
                                <th scope="col" class="text-secondary">Tipo</th>
                                <th scope="col" class="text-secondary">Quantidade</th>
                                <th scope="col" class="text-secondary">Categoria</th>
                                <th scope="col" class="text-secondary"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td id="ultimo-movimento" class="text-secondary custom-cell"></td>
                                <td id="tipo-ultimo-movimento" class="text-secondary custom-cell"></td>
                                <td id="quantidade-ultimo-movimento" class="text-secondary custom-cell"></td>
                                <td id="categoria-ultimo-movimento" class="text-secondary custom-cell"></td>
                                <td class="text-end">
                                    <img src="{% static 'img/registro-2.svg' %}" alt="" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script type="module" src="{% static 'js/telas/estoque.js' %}"></script>
</body>
</html>
<style>
.custom-cell {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-height: 50px;
    width: 150px;
}
.custom-row {
    height: 50px;
}
</style>
